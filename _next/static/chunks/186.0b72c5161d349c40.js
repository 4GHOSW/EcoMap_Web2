"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[186],{38179:function(e,t,n){n.r(t),n.d(t,{default:function(){return NaverMap}});var o=n(57437),s=n(54829),a=n(62601);let tmapAPI=async function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=s.Z.create();r.defaults.baseURL=a.env.NEXT_PUBLIC_CLIENT_API_SERVER,r.defaults.timeout=3e5,r.defaults.headers.common["Content-Type"]="application/json",r.defaults.headers.common.Accept="application/json";let l={method:e,url:t,data:n};return o.hasOwnProperty("timeout")&&(r.defaults.timeout=o.timeout),o.hasOwnProperty("Content-Type")&&(r.defaults.headers.common["Content-Type"]=o["Content-Type"]),o.hasOwnProperty("Accept")&&(r.defaults.headers.common.Accept=o.Accept),o.hasOwnProperty("abortController")&&(l.signal=o.abortController.signal),o.hasOwnProperty("cancelToken")&&(l.cancelToken=o.cancelToken),o.hasOwnProperty("onUploadProgress")&&(l.onUploadProgress=o.onUploadProgress),o.hasOwnProperty("onDownloadProgress")&&(l.onDownloadProgress=o.onDownloadProgress),o.hasOwnProperty("responseType")&&(l.responseType=o.responseType),r.defaults.headers.common.appKey="mdpSbj3hdP9kbQb8HfTOYPv7NDfb4ja57uv1jvTi",r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>(null==e||e.message,Promise.reject(e))),await r(l)},r={WALK_EMISSION:.1,BUS_EMISSION:.04,TRAIN_EMISSION:.03};var l=n(2265),i=n(16691),c=n.n(i);let d={WALK:r.WALK_EMISSION,BUS:r.BUS_EMISSION,SUBWAY:r.TRAIN_EMISSION},m={WALK:{src:"/image/common/walking.png",alt:"도보"},BUS:{src:"/image/common/bus.png",alt:"버스"},SUBWAY:{src:"/image/common/train.png",alt:"지하철"}},CloudBox=e=>{let{value:t}=e;return(0,o.jsx)("div",{className:"relative flex items-center justify-center",children:(0,o.jsxs)("div",{className:"absolute -top-24 h-[60px] w-[100px]",children:[(0,o.jsx)(c(),{src:"/image/common/cloud.png",alt:"cloud",fill:!0,className:"object-contain",priority:!0}),(0,o.jsx)("span",{className:"absolute inset-0 z-10 flex items-center justify-center text-sm",children:t})]})})};var map_RouteInfoCard=e=>{let{legs:t}=e,formatEmission=e=>e>=1?"".concat(e.toFixed(2)," kg CO₂"):"".concat((1e3*e).toFixed(1)," g CO₂");return(0,o.jsxs)("div",{className:"fixed bottom-8 left-1/2 h-[250px] w-[340px] -translate-x-1/2 rounded-xl bg-white p-4 shadow-lg",children:[(0,o.jsxs)("div",{className:"mb-4 text-sm font-medium",children:["총 탄소 배출량",(0,o.jsx)("span",{className:"float-right",children:formatEmission(t.reduce((e,t)=>{let n=d[t.mode]||0,o=t.distance/1e3;return e+n*o},0))})]}),(0,o.jsx)("div",{className:"relative h-28",children:(0,o.jsx)("div",{className:"absolute bottom-0 left-0 right-0 flex w-full items-center",children:t.map((e,t)=>(0,o.jsxs)("div",{className:"relative flex-1",children:[(0,o.jsx)(CloudBox,{value:formatEmission(e.distance/1e3*(d[e.mode]||0))}),(0,o.jsx)("div",{className:"h-2 flex-1",style:{backgroundColor:"WALK"===e.mode?"#666666":"SUBWAY"===e.mode?"#".concat(e.routeColor||"FFA500"):"#4B0082"}}),(0,o.jsx)("div",{className:"absolute bottom-3 left-0",children:(0,o.jsx)("div",{className:"relative h-8 w-8 rounded-full bg-white shadow-md",children:(0,o.jsx)(c(),{src:m[e.mode].src,alt:m[e.mode].alt,fill:!0,className:"object-contain p-1",priority:!0})})}),"WALK"!==e.mode?(0,o.jsxs)("div",{className:"absolute -bottom-10 left-0 whitespace-nowrap text-xs",children:[e.route," ","BUS"===e.mode?"번":""]}):(0,o.jsx)("div",{className:"absolute -bottom-10 left-0 whitespace-nowrap text-xs",children:"도보"})]},t))})})]})};function NaverMap(e){let{startX:t,startY:n,endX:s,endY:a}=e,i=(0,l.useRef)(null),[c,d]=(0,l.useState)([]);return(0,l.useEffect)(()=>{if(!i.current||!window.naver)return;let e=new window.naver.maps.Map(i.current,{center:new window.naver.maps.LatLng(37.5656,126.9769),zoom:14,zoomControl:!0,zoomControlOptions:{position:window.naver.maps.Position.TOP_RIGHT}});if(t&&n&&s&&a){let fetchRoute=async()=>{try{let o=await tmapAPI("POST","https://apis.openapi.sk.com/transit/routes",{startX:t,startY:n,endX:s,endY:a}),l=o.data.metaData.plan.itineraries[0];d(l.legs),console.log(l.legs),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(n),Number(t)),map:e,icon:{content:'<div style="padding: 5px; background: #2196F3; color: white; border-radius: 50%;">출발</div>',anchor:new window.naver.maps.Point(20,20)}}),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(a),Number(s)),map:e,icon:{content:'<div style="padding: 5px; background: #F44336; color: white; border-radius: 50%;">도착</div>',anchor:new window.naver.maps.Point(20,20)}}),l.legs.forEach(t=>{var n;let o=0;if("WALK"===t.mode&&t.steps)t.steps.forEach(n=>{if(!n.linestring)return;let s=n.linestring.split(" "),a=s.map(e=>{let[t,n]=e.split(",").map(Number);return new window.naver.maps.LatLng(n,t)});new window.naver.maps.Polyline({path:a,strokeColor:"#666666",strokeWeight:5,strokeOpacity:.8,map:e}),o+=t.distance*r.WALK_EMISSION});else if(null===(n=t.passShape)||void 0===n?void 0:n.linestring){let n=t.passShape.linestring.split(" "),s=n.map(e=>{let[t,n]=e.split(",").map(Number);return new window.naver.maps.LatLng(n,t)});new window.naver.maps.Polyline({path:s,strokeColor:"#".concat(t.routeColor||"2196F3"),strokeWeight:5,strokeOpacity:.8,map:e}),o+=t.distance*r.BUS_EMISSION}console.log(o)});let i=new window.naver.maps.LatLngBounds(new window.naver.maps.LatLng(Number(n),Number(t)),new window.naver.maps.LatLng(Number(a),Number(s)));e.fitBounds(i)}catch(e){console.error("Route fetch error:",e)}};fetchRoute()}return()=>{null==e||e.destroy()}},[t,n,s,a]),(0,o.jsxs)("div",{className:"relative h-screen w-screen",children:[(0,o.jsx)("div",{ref:i,className:"h-full w-full"}),c.length>0&&(0,o.jsx)(map_RouteInfoCard,{legs:c})]})}}}]);