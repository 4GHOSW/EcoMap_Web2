"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{77878:function(e,t,a){a.r(t),a.d(t,{default:function(){return NaverMap}});var n=a(57437),o=a(54829),s=a(62601);let tmapAPI=async function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=o.Z.create();r.defaults.baseURL=s.env.NEXT_PUBLIC_CLIENT_API_SERVER,r.defaults.timeout=3e5,r.defaults.headers.common["Content-Type"]="application/json",r.defaults.headers.common.Accept="application/json";let l={method:e,url:t,data:a};return n.hasOwnProperty("timeout")&&(r.defaults.timeout=n.timeout),n.hasOwnProperty("Content-Type")&&(r.defaults.headers.common["Content-Type"]=n["Content-Type"]),n.hasOwnProperty("Accept")&&(r.defaults.headers.common.Accept=n.Accept),n.hasOwnProperty("abortController")&&(l.signal=n.abortController.signal),n.hasOwnProperty("cancelToken")&&(l.cancelToken=n.cancelToken),n.hasOwnProperty("onUploadProgress")&&(l.onUploadProgress=n.onUploadProgress),n.hasOwnProperty("onDownloadProgress")&&(l.onDownloadProgress=n.onDownloadProgress),n.hasOwnProperty("responseType")&&(l.responseType=n.responseType),r.defaults.headers.common.appKey="mdpSbj3hdP9kbQb8HfTOYPv7NDfb4ja57uv1jvTi",r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>(null==e||e.message,Promise.reject(e))),await r(l)},r={WALK_EMISSION:.1,BUS_EMISSION:.04,TRAIN_EMISSION:.03};var l=a(2265),i=a(16691),c=a.n(i);let getImagePath=e=>"".concat("/EcoMap_Web2").concat(e),d={WALK:r.WALK_EMISSION,BUS:r.BUS_EMISSION,SUBWAY:r.TRAIN_EMISSION},m={WALK:{src:getImagePath("/image/common/walking.png"),alt:"도보"},BUS:{src:getImagePath("/image/common/bus.png"),alt:"버스"},SUBWAY:{src:getImagePath("/image/common/train.png"),alt:"지하철"}},CloudBox=e=>{let{value:t}=e;return(0,n.jsx)("div",{className:"relative flex items-center justify-center",children:(0,n.jsxs)("div",{className:"absolute -top-24 h-[60px] w-[100px]",children:[(0,n.jsx)(c(),{src:getImagePath("/image/common/cloud.png"),alt:"cloud",fill:!0,className:"object-contain",priority:!0}),(0,n.jsx)("span",{className:"absolute inset-0 z-10 flex items-center justify-center text-sm",children:t})]})})};var map_RouteInfoCard=e=>{let{legs:t}=e,formatEmission=e=>e>=1?"".concat(e.toFixed(2)," kg CO₂"):"".concat((1e3*e).toFixed(1)," g CO₂");return(0,n.jsxs)("div",{className:"fixed bottom-8 left-1/2 h-[250px] w-[340px] -translate-x-1/2 rounded-xl bg-white p-4 shadow-lg",children:[(0,n.jsxs)("div",{className:"mb-4 text-sm font-medium",children:["총 탄소 배출량",(0,n.jsx)("span",{className:"float-right",children:formatEmission(t.reduce((e,t)=>{let a=d[t.mode]||0,n=t.distance/1e3;return e+a*n},0))})]}),(0,n.jsx)("div",{className:"relative h-28",children:(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 flex w-full items-center",children:t.map((e,t)=>(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(CloudBox,{value:formatEmission(e.distance/1e3*(d[e.mode]||0))}),(0,n.jsx)("div",{className:"h-2 flex-1",style:{backgroundColor:"WALK"===e.mode?"#666666":"SUBWAY"===e.mode?"#".concat(e.routeColor||"FFA500"):"#4B0082"}}),(0,n.jsx)("div",{className:"absolute bottom-3 left-0",children:(0,n.jsx)("div",{className:"relative h-8 w-8 rounded-full bg-white shadow-md",children:(0,n.jsx)(c(),{src:m[e.mode].src,alt:m[e.mode].alt,fill:!0,className:"object-contain p-1",priority:!0})})}),"WALK"!==e.mode?(0,n.jsxs)("div",{className:"absolute -bottom-10 left-0 whitespace-nowrap text-xs",children:[e.route," ","BUS"===e.mode?"번":""]}):(0,n.jsx)("div",{className:"absolute -bottom-10 left-0 whitespace-nowrap text-xs",children:"도보"})]},t))})})]})};function NaverMap(e){let{startX:t,startY:a,endX:o,endY:s}=e,i=(0,l.useRef)(null),[c,d]=(0,l.useState)([]);return(0,l.useEffect)(()=>{if(!i.current||!window.naver)return;let e=new window.naver.maps.Map(i.current,{center:new window.naver.maps.LatLng(37.5656,126.9769),zoom:14,zoomControl:!0,zoomControlOptions:{position:window.naver.maps.Position.TOP_RIGHT}});if(t&&a&&o&&s){let fetchRoute=async()=>{try{let n=await tmapAPI("POST","https://apis.openapi.sk.com/transit/routes",{startX:t,startY:a,endX:o,endY:s}),l=n.data.metaData.plan.itineraries[0];d(l.legs),console.log(l.legs),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(a),Number(t)),map:e,icon:{content:'<div style="padding: 5px; background: #2196F3; color: white; border-radius: 50%;">출발</div>',anchor:new window.naver.maps.Point(20,20)}}),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(s),Number(o)),map:e,icon:{content:'<div style="padding: 5px; background: #F44336; color: white; border-radius: 50%;">도착</div>',anchor:new window.naver.maps.Point(20,20)}}),l.legs.forEach(t=>{var a;let n=0;if("WALK"===t.mode&&t.steps)t.steps.forEach(a=>{if(!a.linestring)return;let o=a.linestring.split(" "),s=o.map(e=>{let[t,a]=e.split(",").map(Number);return new window.naver.maps.LatLng(a,t)});new window.naver.maps.Polyline({path:s,strokeColor:"#666666",strokeWeight:5,strokeOpacity:.8,map:e}),n+=t.distance*r.WALK_EMISSION});else if(null===(a=t.passShape)||void 0===a?void 0:a.linestring){let a=t.passShape.linestring.split(" "),o=a.map(e=>{let[t,a]=e.split(",").map(Number);return new window.naver.maps.LatLng(a,t)});new window.naver.maps.Polyline({path:o,strokeColor:"#".concat(t.routeColor||"2196F3"),strokeWeight:5,strokeOpacity:.8,map:e}),n+=t.distance*r.BUS_EMISSION}console.log(n)});let i=new window.naver.maps.LatLngBounds(new window.naver.maps.LatLng(Number(a),Number(t)),new window.naver.maps.LatLng(Number(s),Number(o)));e.fitBounds(i)}catch(e){console.error("Route fetch error:",e)}};fetchRoute()}return()=>{null==e||e.destroy()}},[t,a,o,s]),(0,n.jsxs)("div",{className:"relative h-screen w-screen",children:[(0,n.jsx)("div",{ref:i,className:"h-full w-full"}),c.length>0&&(0,n.jsx)(map_RouteInfoCard,{legs:c})]})}}}]);