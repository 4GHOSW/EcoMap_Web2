"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[186],{38179:function(e,t,s){s.r(t),s.d(t,{default:function(){return NaverMap}});var n=s(57437),a=s(54829),o=s(62601);let tmapAPI=async function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=a.Z.create();r.defaults.baseURL=o.env.NEXT_PUBLIC_CLIENT_API_SERVER,r.defaults.timeout=3e5,r.defaults.headers.common["Content-Type"]="application/json",r.defaults.headers.common.Accept="application/json";let i={method:e,url:t,data:s};return n.hasOwnProperty("timeout")&&(r.defaults.timeout=n.timeout),n.hasOwnProperty("Content-Type")&&(r.defaults.headers.common["Content-Type"]=n["Content-Type"]),n.hasOwnProperty("Accept")&&(r.defaults.headers.common.Accept=n.Accept),n.hasOwnProperty("abortController")&&(i.signal=n.abortController.signal),n.hasOwnProperty("cancelToken")&&(i.cancelToken=n.cancelToken),n.hasOwnProperty("onUploadProgress")&&(i.onUploadProgress=n.onUploadProgress),n.hasOwnProperty("onDownloadProgress")&&(i.onDownloadProgress=n.onDownloadProgress),n.hasOwnProperty("responseType")&&(i.responseType=n.responseType),r.defaults.headers.common.appKey="mdpSbj3hdP9kbQb8HfTOYPv7NDfb4ja57uv1jvTi",r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>(null==e||e.message,Promise.reject(e))),await r(i)},r={WALK_EMISSION:.1,BUS_EMISSION:.04};var i=s(2265),map_RouteInfoCard=e=>{let{legs:t}=e;return(0,n.jsxs)("div",{className:"fixed bottom-8 left-1/2 w-[340px] -translate-x-1/2 rounded-xl bg-white p-4 shadow-lg",children:[(0,n.jsxs)("div",{className:"mb-4 text-sm font-medium",children:["총 탄소 배출량",(0,n.jsxs)("span",{className:"float-right",children:[t.reduce((e,t)=>{let s="WALK"===t.mode?t.distance*r.WALK_EMISSION:t.distance*r.BUS_EMISSION;return e+s},0).toFixed(1)," mg"]})]}),(0,n.jsx)("div",{className:"flex items-center space-x-1",children:t.map((e,s)=>(0,n.jsxs)("div",{className:"flex flex-1 items-center",children:[(0,n.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-gray-100",children:"WALK"===e.mode?(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDEB6"}):"SUBWAY"===e.mode?(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDE87"}):(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDE8C"})}),s<t.length-1&&(0,n.jsx)("div",{className:"h-[2px] flex-1",style:{backgroundColor:e.routeColor?"#".concat(e.routeColor):"#666666"}}),(0,n.jsxs)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 rounded-full bg-white px-2 py-1 text-xs shadow-sm",children:[(e.distance*("WALK"===e.mode?r.WALK_EMISSION:r.BUS_EMISSION)).toFixed(1),"mg"]})]},s))}),(0,n.jsx)("div",{className:"mt-4 text-xs text-gray-600",children:t.map((e,t)=>{var s,a;return(0,n.jsxs)("div",{className:"mb-1 flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"h-2 w-2 rounded-full ".concat("WALK"===e.mode?"bg-gray-400":"bg-[#".concat(e.routeColor||"666666","]"))}),(0,n.jsx)("span",{children:"WALK"===e.mode?"도보":e.route}),"WALK"!==e.mode&&(0,n.jsxs)("span",{className:"text-gray-400",children:[null===(s=e.passStopList)||void 0===s?void 0:s.stationList[0].stationName," → ",null===(a=e.passStopList)||void 0===a?void 0:a.stationList[e.passStopList.stationList.length-1].stationName]})]},t)})})]})};function NaverMap(e){let{startX:t,startY:s,endX:a,endY:o}=e,l=(0,i.useRef)(null),[d,c]=(0,i.useState)([]);return(0,i.useEffect)(()=>{if(!l.current||!window.naver)return;let e=new window.naver.maps.Map(l.current,{center:new window.naver.maps.LatLng(37.5656,126.9769),zoom:14,zoomControl:!0,zoomControlOptions:{position:window.naver.maps.Position.TOP_RIGHT}});if(t&&s&&a&&o){let fetchRoute=async()=>{try{let n=await tmapAPI("POST","https://apis.openapi.sk.com/transit/routes",{startX:t,startY:s,endX:a,endY:o});console.log(n);let i=n.data.metaData.plan.itineraries[0];c(i.legs),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(s),Number(t)),map:e,icon:{content:'<div style="padding: 5px; background: #2196F3; color: white; border-radius: 50%;">출발</div>',anchor:new window.naver.maps.Point(20,20)}}),new window.naver.maps.Marker({position:new window.naver.maps.LatLng(Number(o),Number(a)),map:e,icon:{content:'<div style="padding: 5px; background: #F44336; color: white; border-radius: 50%;">도착</div>',anchor:new window.naver.maps.Point(20,20)}}),i.legs.forEach(t=>{var s;let n=0;if("WALK"===t.mode&&t.steps)t.steps.forEach(s=>{if(!s.linestring)return;let a=s.linestring.split(" "),o=a.map(e=>{let[t,s]=e.split(",").map(Number);return new window.naver.maps.LatLng(s,t)});new window.naver.maps.Polyline({path:o,strokeColor:"#666666",strokeWeight:5,strokeOpacity:.8,map:e}),n+=t.distance*r.WALK_EMISSION});else if(null===(s=t.passShape)||void 0===s?void 0:s.linestring){let s=t.passShape.linestring.split(" "),a=s.map(e=>{let[t,s]=e.split(",").map(Number);return new window.naver.maps.LatLng(s,t)});new window.naver.maps.Polyline({path:a,strokeColor:"#".concat(t.routeColor||"2196F3"),strokeWeight:5,strokeOpacity:.8,map:e}),n+=t.distance*r.BUS_EMISSION}console.log(n)});let l=new window.naver.maps.LatLngBounds(new window.naver.maps.LatLng(Number(s),Number(t)),new window.naver.maps.LatLng(Number(o),Number(a)));e.fitBounds(l)}catch(e){console.error("Route fetch error:",e)}};fetchRoute()}return()=>{null==e||e.destroy()}},[t,s,a,o]),(0,n.jsxs)("div",{className:"relative h-screen w-screen",children:[(0,n.jsx)("div",{ref:l,className:"h-full w-full"}),d.length>0&&(0,n.jsx)(map_RouteInfoCard,{legs:d})]})}}}]);